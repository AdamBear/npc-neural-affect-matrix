# 🚀 Web UI 快速开始

5 分钟快速上手 NPC Neural Affect Matrix Web UI

## 步骤 1: 启动 API 服务器

在项目根目录运行：

```bash
cargo run --release
```

看到以下输出表示服务器启动成功：
```
INFO Starting NPC Neural Affect Matrix Web Server on 0.0.0.0:3000
INFO Health check endpoint: http://0.0.0.0:3000/health
INFO API base URL: http://0.0.0.0:3000/api/v1
```

## 步骤 2: 打开 Web UI

### Windows
```bash
start web-ui\index.html
```

### Linux/Mac
```bash
open web-ui/index.html
# 或
xdg-open web-ui/index.html
```

## 步骤 3: 初始化系统

1. **检查连接**
   - 页面加载后自动检查服务器状态
   - 状态应该显示为 "已连接" (绿色)

2. **初始化模型**
   - 点击 "初始化模型" 按钮
   - 首次运行会下载模型文件（约 100MB+）
   - 等待状态变为 "模型已就绪"

## 步骤 4: 创建你的第一个 NPC

### 示例 1: 友好商人

```
NPC 名称: 马库斯
背景故事: 经营杂货店20年的友好商人，以公平价格和好建议闻名。
Valence: 0.3   (略微积极)
Arousal: -0.1  (略微平静)
记忆衰减率: 0.1
```

点击 "创建 NPC"

## 步骤 5: 测试第一个交互

1. 在 "交互文本" 框输入：
   ```
   谢谢你多年来的帮助！你的店铺是这个村子最好的！
   ```

2. 在 "来源 ID" 框输入：
   ```
   player
   ```

3. 点击 "评估交互"

4. 观察结果：
   - **Valence** 应该增加（更积极）
   - **Arousal** 可能略微增加
   - **环状图** 中的点会移动
   - **操作日志** 显示详细信息

## 步骤 6: 尝试不同的交互

### 正面交互
```
你的价格总是很公道，我很欣赏你的诚实。
```

### 负面交互
```
你欺骗了我！这些货物质量太差了！
```

### 来自不同角色
改变 "来源 ID" 为 `thief`:
```
把你的金子都交出来！
```

## 步骤 7: 查看情绪变化

1. **获取整体情绪**
   - 点击 "获取当前情绪"
   - 查看所有交互的综合情绪

2. **获取特定来源情绪**
   - 输入来源 ID: `player`
   - 点击 "获取特定来源情绪"
   - 查看 NPC 对玩家的情绪

3. **对比不同来源**
   - 输入来源 ID: `thief`
   - 点击 "获取特定来源情绪"
   - 比较 NPC 对不同角色的情绪

## 步骤 8: 管理记忆

1. **查看记忆**
   - 点击 "获取记忆"
   - 查看所有交互的历史记录

2. **清除记忆**
   - 点击 "清除记忆"
   - NPC 会忘记所有过往，回到初始状态

## 🎯 尝试更多场景

### 场景 1: 守卫与入侵者

**创建守卫 NPC**:
```
名称: 艾伦
背景: 城门守卫，严格执行规则
Valence: -0.1
Arousal: 0.2
```

**测试交互**:
1. "早上好，守卫先生。" (citizen)
2. "你在这里干什么？出示通行证！" (suspicious_person)
3. "感谢你保护我们的安全！" (mayor)

### 场景 2: 旅店老板

**创建老板 NPC**:
```
名称: 萝丝
背景: 经营旅店30年，见过各种各样的旅客
Valence: 0.2
Arousal: 0.0
```

**测试交互**:
1. "房间很舒适，谢谢款待！" (traveler)
2. "这食物难以下咽！" (rude_customer)
3. "您的故事真有趣！" (curious_bard)

### 场景 3: 铁匠

**创建铁匠 NPC**:
```
名称: 格伦
背景: 技艺精湛的铁匠，对工作充满热情
Valence: 0.0
Arousal: 0.3
```

**测试交互**:
1. "这把剑真是杰作！" (warrior)
2. "你的价格太贵了！" (cheap_customer)
3. "能教我你的技艺吗？" (apprentice)

## 📊 理解情绪数值

### Valence (愉悦度)

| 范围 | 情绪 | 示例 |
|------|------|------|
| +0.7 ~ +1.0 | 非常积极 | 喜悦、爱、感激 |
| +0.3 ~ +0.7 | 积极 | 满意、友好、信任 |
| -0.3 ~ +0.3 | 中性 | 平静、中立 |
| -0.7 ~ -0.3 | 消极 | 不满、失望 |
| -1.0 ~ -0.7 | 非常消极 | 愤怒、恐惧、悲伤 |

### Arousal (唤醒度)

| 范围 | 状态 | 示例 |
|------|------|------|
| +0.7 ~ +1.0 | 非常兴奋 | 激动、狂喜、恐慌 |
| +0.3 ~ +0.7 | 活跃 | 警觉、兴奋 |
| -0.3 ~ +0.3 | 平静 | 正常、稳定 |
| -0.7 ~ -0.3 | 放松 | 平和、满足 |
| -1.0 ~ -0.7 | 疲惫 | 困倦、抑郁 |

### 组合情绪示例

| Valence | Arousal | 情绪 |
|---------|---------|------|
| +0.8 | +0.7 | 兴高采烈 😄 |
| +0.7 | -0.5 | 平静满足 😌 |
| -0.7 | +0.8 | 愤怒恐惧 😠😱 |
| -0.6 | -0.6 | 悲伤沮丧 😢 |
| 0.0 | 0.0 | 中性平和 😐 |

## 💡 使用技巧

### 1. 记忆衰减率的影响

- **低衰减 (0.0-0.1)**: NPC 记忆力好，长期记住交互
- **中衰减 (0.1-0.3)**: 平衡的记忆，适合大多数场景
- **高衰减 (0.3-1.0)**: 快速遗忘，适合健忘角色

### 2. 初始性格设置

- **乐观角色**: Valence > 0.3
- **悲观角色**: Valence < -0.3
- **高能量角色**: Arousal > 0.3
- **平静角色**: Arousal < -0.3

### 3. 来源 ID 管理

使用一致的 ID 来跟踪不同角色：
- `player` - 玩家
- `companion` - 同伴
- `enemy` - 敌人
- `merchant` - 商人
- `guard` - 守卫

### 4. 测试建议

1. **先测试极端情况**
   - 非常正面的交互
   - 非常负面的交互

2. **观察情绪变化**
   - 每次交互后查看情绪
   - 记录数值变化

3. **对比不同来源**
   - 同一 NPC 对不同角色的反应
   - 使用 "获取特定来源情绪"

4. **记忆管理**
   - 定期查看记忆积累
   - 测试清除后的重置效果

## 🐛 常见问题

### Q: 状态显示 "未连接"
**A**: 确保 API 服务器正在运行 (`cargo run --release`)

### Q: 模型初始化很慢
**A**: 首次运行需要下载模型文件（约100MB+），需要等待几分钟

### Q: 交互评估没有反应
**A**: 确保已经创建并选择了一个 NPC

### Q: 情绪数值没有变化
**A**: 检查来源 ID 是否正确，尝试更极端的交互文本

### Q: 记忆显示为空
**A**: 需要先进行至少一次交互评估

## 🎓 进阶使用

### 多 NPC 场景

1. 创建多个不同性格的 NPC
2. 使用相同的交互文本测试
3. 对比不同 NPC 的情绪反应
4. 理解性格如何影响情绪

### 情绪演变追踪

1. 记录初始情绪
2. 进行一系列交互
3. 定期记录情绪变化
4. 绘制情绪演变曲线

### 关系动态测试

1. 使用不同的来源 ID
2. 模拟多角色互动
3. 追踪 NPC 对不同角色的情绪
4. 观察关系网络形成

## 📚 更多资源

- **API 文档**: [WEB_API.md](../WEB_API.md)
- **详细说明**: [README.md](README.md)
- **快速入门**: [QUICKSTART.md](../QUICKSTART.md)

## 🎉 开始你的旅程！

现在你已经掌握了所有基础知识，开始创建你自己的 NPC 并探索情绪系统吧！

记住：
- 🧪 多实验不同的交互
- 📊 观察情绪的细微变化
- 💭 思考如何在游戏中应用
- 🎮 享受创建有生命力的 NPC 的乐趣！
